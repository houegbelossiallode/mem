{% extends 'template.html.twig' %}

{% block title %}VenteRepas index{% endblock %}

{% block body %}

{% for flash_error in app.flashes('error') %}
<div class="alert alert-danger" role="alert">{{ flash_error }}</div>
{% endfor %}

<style>
.disabled{
  pointer-events: none;
}
</style>

        <div class="container-fluid" >
        <div class="card shadow mb-4">
        <div class="card-header py-3">
        <div class="card-body table-responsive">
        <div class="container" >

      <div class="row">
      <table class="table table-bordered table-striped table-highlight">
      <a href="{{path('app_vente_repas_new')}}" class="btn btn-success mb-3">Nouvelle vente<i class="bi bi-plus"></i></a>
        <thead>
            <tr>
                
                <th>Accompagnement</th>
                <th>Protéine</th>
                <th>Quantité vendue</th>
                <th>Prix</th>
                <th>montant</th>
                {% if is_granted('ROLE_ADMIN')%}
                <th>Auteur</th>
                {% endif %}
                <th>Date</th>
                <th>Statut</th>
                {% if is_granted('ROLE_ADMIN')%}
                <th>action 1</th>
                <th>action 2</th>
                {% endif %}
                <th>action</th>  
            </tr>
        </thead>
        <tbody>
        {% for vente_repa in vente_repas %}
            <tr>
                
                <td>
                    {% if vente_repa.repas.accompagnement is defined %}
                    {{vente_repa.repas.accompagnement }}
                    {% endif %}
                </td>
                <td>
                    {% if vente_repa.proteine.nom is defined %}
                    {{vente_repa.proteine.nom }}
                    {% endif %}
                </td>
                <td>{{ vente_repa.qteVendue }}</td>
                <td>{{ vente_repa.prixVente }}</td>
                <td>{{ vente_repa.montant }}</td>
                {% if is_granted('ROLE_ADMIN')%}
                <td>{{ vente_repa.user.nom }}</td>
                {% endif %}
                <td>{{ vente_repa.date|date('d-m-Y') }}</td>
                <td>{{ vente_repa.statut}}</td>
                {% if is_granted('ROLE_ADMIN')%}
                <td>
                <a href="{{ path('app_vente_repas_edit', {id : vente_repa.id} )}}" class="btn btn-sm btn-outline-success" >Modifier</a>
                </td>
                <td>
                <a href="{{ path('app_vente_repas_delete', {id : vente_repa.id} )}}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Etes-vous sûr de vouloir exécuter cette action')">Supprimer</a>
                </td>
            {% endif %}
            <td>
                {% if vente_repa.statut == 'annuler' %} 
               <a href="{{ path('app_vente_repas_annuler', {id : vente_repa.id} )}}" class="btn btn-sm btn-outline-primary disabled" >ANNULER</a>
               {% else %}
               <a href="{{ path('app_vente_repas_annuler', {id : vente_repa.id} )}}" class="btn btn-sm btn-outline-primary">ANNULER</a>
               {% endif %}
            </td>
            </tr>
          {% else %}
            <tr>
                <td colspan="7">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}
